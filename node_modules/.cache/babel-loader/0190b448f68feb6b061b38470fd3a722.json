{"ast":null,"code":"import _toConsumableArray from\"/Users/andrewburchett/thinkful/capstone/dontquit-stayfit-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/andrewburchett/thinkful/capstone/dontquit-stayfit-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/andrewburchett/thinkful/capstone/dontquit-stayfit-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/andrewburchett/thinkful/capstone/dontquit-stayfit-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/andrewburchett/thinkful/capstone/dontquit-stayfit-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Accountability.css';import config from'../config';import TokenService from'../Service/token-service';var Accountability=/*#__PURE__*/function(_React$Component){_inherits(Accountability,_React$Component);var _super=_createSuper(Accountability);function Accountability(){var _this;_classCallCheck(this,Accountability);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={feedback:[],editFeedback:null};_this.componentDidMount=function(){fetch(\"\".concat(config.API_ENDPOINT,\"/feedback\"),{headers:{'Authorization':\"Bearer \".concat(TokenService.getAuthToken())}}).then(function(feedbackLog){if(!feedbackLog.ok){return feedbackLog.json().then(function(e){return Promise.reject(e);});}return feedbackLog.json();}).then(function(feedbackLog){_this.setState({feedback:feedbackLog,date_created:new Date()});});};_this.addFeedback=function(e){e.preventDefault();var fb=e.target.content.value;fetch(\"\".concat(config.API_ENDPOINT,\"/feedback\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(TokenService.getAuthToken())},body:JSON.stringify({content:fb,date_created:new Date()})}).then(function(res){return res.json();}).then(function(fb){_this.setState({feedback:[].concat(_toConsumableArray(_this.state.feedback),[fb])});_this.props.history.push('/accountability');});e.target.reset();};_this.deleteFeedback=function(e,index){e.preventDefault();console.log(index);fetch(\"\".concat(config.API_ENDPOINT,\"/feedback/\").concat(index),{method:'DELETE',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(TokenService.getAuthToken())}}).then(function(res){if(!res.ok)return res.json().then(function(e){return Promise.reject(e);});}).then(function(){_this.setState({feedback:_this.state.feedback.filter(function(fb){return fb.id!==index;})});});};_this.updateData=function(e){e.preventDefault();var data={content:e.target.content.value};fetch(\"\".concat(config.API_ENDPOINT,\"/feedback/\").concat(_this.state.editFeedback),{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(TokenService.getAuthToken())},body:JSON.stringify(data)}).then(function(fb){_this.setState({feedback:_this.state.feedback.map(function(fb){if(fb.id===_this.state.editFeedback){fb.content=data.content;}return fb;}),editFeedback:null});_this.props.history.push('/accountability');});};_this.openEdit=function(id){_this.setState({editFeedback:id});};_this.cancelAddedFeedback=function(){_this.setState({editFeedback:null});};_this.handleClickCancel=function(){_this.props.history.push('/homepage');};return _this;}_createClass(Accountability,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"REFLECT ON TODAY, PLAN FOR TOMORROW\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.addFeedback},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"accountability\"}),/*#__PURE__*/React.createElement(\"textarea\",{className:\"feedback\",name:\"content\",rows:\"8\",cols:\"25\",required:true}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"ENTER\"),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",onClick:this.handleClickCancel},\"CANCEL\")),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h4\",{className:\"feedbackLog\"},\"ACCOUNTABILITY LOG:\"),/*#__PURE__*/React.createElement(\"ul\",null,this.state.feedback.map(function(item,index){return/*#__PURE__*/React.createElement(\"li\",{key:index},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(e){return _this2.deleteFeedback(e,item.id);}},\"Delete\"),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this2.openEdit(item.id);}},\"Update\"),_this2.state.editFeedback===item.id?/*#__PURE__*/React.createElement(\"form\",{onSubmit:_this2.updateData},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"accountability\"}),/*#__PURE__*/React.createElement(\"textarea\",{name:\"content\",required:true}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"ENTER\"),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",onClick:_this2.cancelAddedFeedback},\"CANCEL\")):\"\",new Date(item.date_created).toLocaleTimeString(\"en-US\")+\" \",new Date(item.date_created).toLocaleTimeString(\"en-US\")+\": \",item.content);}))));}}]);return Accountability;}(React.Component);export default Accountability;","map":{"version":3,"sources":["/Users/andrewburchett/thinkful/capstone/dontquit-stayfit-client/src/Accountability/Accountability.js"],"names":["React","config","TokenService","Accountability","state","feedback","editFeedback","componentDidMount","fetch","API_ENDPOINT","headers","getAuthToken","then","feedbackLog","ok","json","e","Promise","reject","setState","date_created","Date","addFeedback","preventDefault","fb","target","content","value","method","body","JSON","stringify","res","props","history","push","reset","deleteFeedback","index","console","log","filter","id","updateData","data","map","openEdit","cancelAddedFeedback","handleClickCancel","item","toLocaleTimeString","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport './Accountability.css'\nimport config from '../config'\nimport TokenService from '../Service/token-service'\n\nclass Accountability extends React.Component {\n    state = {\n        feedback: [],\n        editFeedback: null\n    }\n\n    componentDidMount = () => {\n        fetch(`${config.API_ENDPOINT}/feedback`, {\n            headers: {\n                'Authorization': `Bearer ${TokenService.getAuthToken()}`\n            },\n        })\n        .then(feedbackLog => {\n            if(!feedbackLog.ok) {\n                return feedbackLog.json().then((e) => Promise.reject(e))\n            }\n            return feedbackLog.json()\n        })\n        .then(feedbackLog => {\n            this.setState({\n                feedback: feedbackLog,\n                date_created: new Date()\n            })\n        })\n    }\n\n    addFeedback = e => {\n        e.preventDefault();\n        const fb = e.target.content.value;\n        fetch(`${config.API_ENDPOINT}/feedback`, {\n            method: 'POST', \n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${TokenService.getAuthToken()}`\n\n            },\n            body: JSON.stringify({\n                content: fb,\n                date_created: new Date()\n            })\n        })\n        .then(res => res.json())\n        .then((fb) => {\n            this.setState({\n                feedback: [...this.state.feedback, fb]\n            })\n            this.props.history.push('/accountability')\n        })\n        e.target.reset()        \n    }\n\n    deleteFeedback = (e, index) => {\n        e.preventDefault()\n        console.log(index)\n        fetch(`${config.API_ENDPOINT}/feedback/${index}`, {\n            method: 'DELETE', \n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${TokenService.getAuthToken()}`\n            }\n        })\n        .then(res => { \n            if (!res.ok) \n                return res.json().then(e => Promise.reject(e))\n        })\n        .then(() => {\n            this.setState({\n                feedback: this.state.feedback.filter(fb => fb.id !== index)\n            })\n        })   \n    }\n\n    updateData = (e) => {\n        e.preventDefault()\n        const data = { \n            content: e.target.content.value\n        }\n        fetch(`${config.API_ENDPOINT}/feedback/${this.state.editFeedback}`, {\n            method: 'PATCH', \n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${TokenService.getAuthToken()}`\n            },\n            body: JSON.stringify(data)\n        })\n        .then((fb) => {\n            this.setState({\n                feedback: this.state.feedback.map(fb => { \n                    if(fb.id === this.state.editFeedback) {\n                        fb.content = data.content\n                    }\n                    return fb\n                }), \n                editFeedback: null\n            })\n            this.props.history.push('/accountability')\n        })\n    }\n\n    openEdit = (id) => {\n        this.setState({\n            editFeedback: id\n        })\n    }\n\n    cancelAddedFeedback = () => {\n        this.setState({\n            editFeedback: null\n        })\n    }\n\n    handleClickCancel = () => {\n        this.props.history.push('/homepage')\n    }\n\n    \n    render() {\n        return(\n            <div>\n                <main>\n                    <h2>REFLECT ON TODAY, PLAN FOR TOMORROW</h2>\n                        <form onSubmit={this.addFeedback}>\n                            <label htmlFor=\"accountability\"></label>\n                            <textarea className=\"feedback\" name='content' rows=\"8\" cols=\"25\" required></textarea>\n                            <br/>\n                            <button type='submit'>ENTER</button>\n                            <button type='submit' onClick={this.handleClickCancel}>CANCEL</button>\n                        </form>\n                    <br/>\n                    <h4 className=\"feedbackLog\" >ACCOUNTABILITY LOG:</h4>\n                    <ul>\n                        {this.state.feedback.map((item, index) => (\n                                \n                                <li key={index}>\n                                <button onClick={(e) => this.deleteFeedback(e, item.id)}>Delete</button>\n                                <button onClick={() => this.openEdit(item.id)}>Update</button>\n                                {this.state.editFeedback === item.id ? \n                                (<form onSubmit={this.updateData}>\n                                    <label htmlFor=\"accountability\"></label>\n                                    <textarea name='content' required></textarea>\n                                    <br/>\n                                    <button type='submit'>ENTER</button>\n                                    <button type='submit' onClick={this.cancelAddedFeedback}>CANCEL</button>\n                                </form>) : \"\" }\n\n                                    {new Date(item.date_created).toLocaleTimeString(\"en-US\") + \" \"}\n                                    {new Date(item.date_created).toLocaleTimeString(\"en-US\") + \": \"}\n                                    {item.content}\n                                    \n                                </li>\n                            ))}\n                    </ul>\n                </main>\n            </div>\n        )\n    }\n}\n\nexport default Accountability"]},"metadata":{},"sourceType":"module"}